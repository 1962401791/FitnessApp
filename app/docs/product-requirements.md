# 产品需求设计文档

> 用于展示产品需求与设计方向，便于后续沟通与迭代。

---

## 1. 产品概述

### 1.1 定位

面向 Android（可选桌面）的健身类 App，核心能力为饮食记录与三大营养素摄入计算，后续可扩展体态/姿势矫正等能力。

### 1.2 目标用户（待细化）

- 有意控制饮食、关注蛋白质/碳水/脂肪摄入的用户
- 健身人群（增肌/减脂）
- 后续可根据反馈补充更细的用户画像

---

## 2. 使用模式与流程

App 启动后先展示**模式选择页**，用户选择进入「游客模式」或「登录模式」。Beta 测试版本中，登录模式按钮可置灰，仅游客模式可用。

选择模式后，首次进入需完成**基础信息录入**（年龄、身高必填，作为基础代谢计算依据），之后才进入主界面。再次启动时若已有本地数据，可跳过该步直接进入主界面。

### 2.1 游客模式

| 项目 | 说明 |
|------|------|
| 触发方式 | 在启动页选择「游客模式」进入 |
| 功能范围 | 三大营养素计算、饮食记录、每日汇总、时段划分 |
| 数据 | 仅本地存储，不云同步 |
| 限制 | 无历史跨设备、无云端备份 |

### 2.2 登录模式

| 项目 | 说明 |
|------|------|
| 触发方式 | 在启动页选择「登录模式」，需注册/登录账号 |
| 功能范围 | 尚未规划，预留扩展空间 |
| 可能的扩展 | 云端同步、跨设备、训练计划、社区等 |
| Beta 阶段 | 入口置灰，不可点击，仅展示 |

---

## 3. 核心功能

### 3.1 三大营养素计算

- **输入**：食物 + 份量（克或份）
- **输出**：蛋白质（g）、碳水（g）、脂肪（g）、热量（kcal）
- **计算逻辑**：`(每100g 营养值 / 100) × 摄入克数`
- **数据来源**：优先使用现有开源数据（如 Open Food Facts、USDA FoodData Central 等）

### 3.2 基础代谢与基础信息

用户选择模式后，**首次使用必须输入**：

| 字段 | 必填 | 说明 |
|------|------|------|
| 年龄 | 是 | 周岁 |
| 身高 | 是 | cm，用于 BMR 计算 |
| 体重 | 建议 | kg，用于更精确的 BMR 及运动消耗；未填时可暂用默认估算 |
| 性别 | 可选 | 影响 BMR 公式系数，可默认「男性」 |

**基础代谢率（BMR）**：采用 Mifflin-St Jeor 等通用公式，依据年龄、身高、体重、性别计算。仅年龄+身高时，可用简化公式或默认体重估算，后续在设置中补全体重后可重算。

### 3.3 饮食记录与时段

- **时段**：早餐、中餐、晚餐、加餐
- **加餐**：可在任意时刻记录，不限定具体时间点
- **展示**：日汇总可按时段分组（可选），便于查看三餐 + 加餐分布

### 3.4 运动与消耗

- **运动记录**：用户可添加运动，用于计算当日运动消耗。
- **输入**：运动类型（如跑步、步行、骑行、游泳等预设项）、持续时长（分钟）、可选强度。
- **计算**：运动消耗 ≈ MET × 体重(kg) × 时长(h)，MET 由运动类型及强度查表获得。
- **展示**：每日总结中展示「摄入 vs 基础代谢 + 运动消耗」，以及热量盈亏（盈余/缺口）。

### 3.5 页面结构与交互流程

```
启动 → 模式选择(游客/登录) → 基础信息(年龄/身高/体重/性别，首次必填) → 主界面
```

| 页面 | 功能 |
|------|------|
| **启动页（模式选择）** | 游客模式 / 登录模式；Beta 版登录置灰 |
| **基础信息页** | 年龄、身高必填；体重、性别建议/可选；仅首次或未填写时展示 |
| 首页 | 快捷入口（饮食记录、运动记录、每日总结、设置） |
| 饮食记录 | 今日列表 + 添加食物（含时段选择） |
| 添加食物 | 搜索/选择食物 + 输入份量 + 选择时段 |
| 运动记录 | 今日运动列表 + 添加运动 |
| 添加运动 | 选择类型 + 时长 + 可选强度 |
| 每日总结 | 摄入、BMR、运动消耗、热量盈亏；三大营养素与目标对比 |
| 设置 | 基础信息修改、每日目标、单位、关于 |

---

## 4. 非功能需求与扩展

### 4.1 扩展方向

- **姿势/体态矫正**：多种动作识别与矫正提示
- **登录模式功能**：待规划
- **外部数据**：接入食物 API、导入导出

### 4.2 技术约束

- Android 为主平台，可选桌面支持
- 本地优先，离线可用
- 数据格式便于后续导出、迁移

---

## 5. 已确认的产品细节

| 项目 | 结论 |
|------|------|
| 模式选择 | 启动后必选；Beta 登录置灰 |
| 基础信息 | 年龄、身高必填；体重、性别建议/可选，用于 BMR 及运动消耗 |
| 时段时间边界 | 仅作为标签，无默认时间区间 |
| 加餐数量 | 不限制，加餐仅作为记录数据的另一入口 |
| 食物单位 | 支持「克」和「份」；份需用户自定义一份对应的克数 |
| 运动记录 | 可添加运动，用于运动消耗计算，参与每日热量盈亏展示 |
| 历史记录 | 本地记录无期限；被删后仅支持恢复 1 年内的数据 |
| 登录模式优先功能 | 云同步、训练计划、社区等，待后续细化 |
| 姿势矫正 | 首期动作类型与交互方式，待后续细化 |
---

## 6. 设计说明

本节为当前采纳的产品设计逻辑，供后续调整参考。

### 6.1 启动与基础信息流程

1. 启动 → 模式选择（游客 / 登录，Beta 登录置灰）
2. 选择游客模式 → 判断是否已填写基础信息
   - 未填写 → 进入基础信息页，完成年龄、身高（及建议的体重、性别）后进入首页
   - 已填写 → 直接进入首页
3. 基础信息支持在「设置」中修改，修改后 BMR、运动消耗等重新计算

### 6.2 运动记录流程

1. 首页或每日总结 → 进入「运动记录」
2. 今日运动列表展示，可添加、删除
3. 添加运动：选择类型（预设 MET 表）→ 输入时长（分钟）→ 可选强度
4. 运动消耗 = MET × 体重(kg) × 时长(h)，汇总到当日「运动消耗」
5. 每日总结展示：摄入 | BMR | 运动消耗 | 总消耗 | 热量盈亏

### 6.3 文档维护

- 本文档随产品讨论持续更新
- 重大变更可在 `log.md` 中记录
- 技术实现详见 `docs/decisions.md`、`todo.md`
